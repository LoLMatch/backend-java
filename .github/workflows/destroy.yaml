name: "Destroy the infrastructure"
on:
    workflow_dispatch:

jobs:
    destroy:
        runs-on: ubuntu-latest
        steps:

        - name: Checkout
          uses: actions/checkout@v2

        - name: 'Authenticate with Google Cloud'
          uses: 'google-github-actions/auth@v0'
          with:
            credentials_json: '${{ secrets.GCP_CREDENTIALS }}'

        - name: 'Set up Terraform'
          uses: hashicorp/setup-terraform@v3

        - name: 'Terraform destroy'
          run: |
            terraform destroy -auto-approve -var="project_id=${{ secrets.PROJECT_ID }}
      
        
